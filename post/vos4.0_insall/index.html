<!DOCTYPE html>
<html lang="zh" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>vos 3000 2.1.4.0 安装 - Myki的博客</title>
  <meta name="description" content="#linux不记录痕迹
unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG
export HISTFILE=/dev/null
export HISTSIZE=0
export HISTFILESIZE=0
">
  <meta name="author" content="Myki"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Myki的博客",
    
    "url": "https:\/\/www.1nth.com\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/www.1nth.com\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/www.1nth.com\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/www.1nth.com\/post\/vos4.0_insall\/",
          "name": "Vos 3000 2.1.4.0 安装"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Myki"
  },
  "headline": "vos 3000 2.1.4.0 安装",
  "description" : "#linux不记录痕迹\runset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG\rexport HISTFILE=\/dev\/null\rexport HISTSIZE=0\rexport HISTFILESIZE=0\r",
  "inLanguage" : "zh",
  "wordCount":  3080 ,
  "datePublished" : "2019-11-18T11:27:22",
  "dateModified" : "2019-11-18T11:27:22",
  "image" : "https:\/\/www.1nth.com\/img\/avatar-icon.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "https:\/\/www.1nth.com\/post\/vos4.0_insall\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/www.1nth.com\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/www.1nth.com\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="vos 3000 2.1.4.0 安装" />
<meta property="og:description" content="#linux不记录痕迹
unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG
export HISTFILE=/dev/null
export HISTSIZE=0
export HISTFILESIZE=0
">
<meta property="og:image" content="https://www.1nth.com/img/avatar-icon.png" />
<meta property="og:url" content="https://www.1nth.com/post/vos4.0_insall/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Myki的博客" />

  <meta name="twitter:title" content="vos 3000 2.1.4.0 安装" />
  <meta name="twitter:description" content="#linux不记录痕迹
unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG
export HISTFILE=/dev/null
export HISTSIZE=0
export HISTFILESIZE=0
">
  <meta name="twitter:image" content="https://www.1nth.com/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@MykiFan" />
  <meta name="twitter:creator" content="@MykiFan" />
  <link href='https://www.1nth.com/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.61.0" />
  <link rel="alternate" href="https://www.1nth.com/index.xml" type="application/rss+xml" title="Myki的博客"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://www.1nth.com/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://www.1nth.com/css/syntax.css" /><link rel="stylesheet" href="https://www.1nth.com/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-154483127-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.1nth.com/">Myki的博客</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="主页" href="https://www.1nth.com/">主页</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Samples</a>
              <div class="navlinks-children">
                
                  <a href="https://www.1nth.com/post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="https://www.1nth.com/post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="https://www.1nth.com/post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="https://www.1nth.com/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="https://www.1nth.com/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Myki的博客" href="https://www.1nth.com/">
            <img class="avatar-img" src="https://www.1nth.com/img/avatar-icon.png" alt="Myki的博客" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>vos 3000 2.1.4.0 安装</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;15&nbsp;
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;3080&nbsp;
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Myki
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#6272a4">#linux不记录痕迹</span>
<span style="color:#8be9fd;font-style:italic">unset</span> HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG
<span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">HISTFILE</span><span style="color:#ff79c6">=</span>/dev/null
<span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">HISTSIZE</span><span style="color:#ff79c6">=</span>0
<span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">HISTFILESIZE</span><span style="color:#ff79c6">=</span>0
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;Email:21kixc@gmail.com&#34;</span>
wget http://oss.1nth.com/vospag/in.sh.x <span style="color:#ff79c6">&amp;&amp;</span> chmod <span style="color:#bd93f9">777</span> in.sh.x <span style="color:#ff79c6">&amp;&amp;</span> ./in.sh.x


<span style="color:#6272a4">#过滤数字</span>
cat server.xml | grep -P <span style="color:#f1fa8c">&#39;\d+&#39;</span>
grep -Eo <span style="color:#f1fa8c">&#39;[0-9]+&#39;</span> server.xml  <span style="color:#6272a4">#o 只取数字</span>

rpm -ivh emp*.rpm --force --nodeps --nomd5

<span style="color:#6272a4">#解决web超时问题</span>
vi /etc/rc.d/init.d/vos3000websv 
su - kunshi -c <span style="color:#f1fa8c">&#34;cd /home/kunshi/vos3000/webserver/bin;/home/kunshi/vos3000/webserver/bin/vos3000webserver -x 1500 -r /home/kunshi/.run/vos3000webserver.pid &gt; /dev/null 2&gt;&amp;1&#34;</span>

vi /etc/rc.d/init.d/vos3000webct
su - kunshiweb -c <span style="color:#f1fa8c">&#34;export JAVA_OPTS=-Xmx2048m;cd /home/kunshiweb/base/apache-tomcat/bin;/home/kunshiweb/base/apache-tomcat/bin/startup.sh &gt;/dev/null 2&gt;&amp;1 &amp;&#34;</span>
<span style="color:#6272a4">#或者切换用户</span>
su kunshiweb
/home/kunshiweb/base/jdk_default/bin/java -Djava.util.logging.config.file<span style="color:#ff79c6">=</span>/home/kunshiweb/base/apache-tomcat/conf/logging.properties -Xmx2048m -Djava.util.logging.manager<span style="color:#ff79c6">=</span>org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs<span style="color:#ff79c6">=</span>/home/kunshiweb/base/apache-tomcat/endorsed -classpath /home/kunshiweb/base/apache-tomcat/bin/bootstrap.jar:/home/kunshiweb/base/apache-tomcat/bin/tomcat-juli.jar -Dcatalina.base<span style="color:#ff79c6">=</span>/home/kunshiweb/base/apache-tomcat -Dcatalina.home<span style="color:#ff79c6">=</span>/home/kunshiweb/base/apache-tomcat -Djava.io.tmpdir<span style="color:#ff79c6">=</span>/home/kunshiweb/base/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start

<span style="color:#6272a4">#astrc 每天3点04分删除90天前的录音文件</span>
<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;04 3 * * *  find /var/record/* -type d  -mtime +90  -name &#34;</span>*<span style="color:#f1fa8c">&#34; -exec rm -rf {} \;&#34;</span> &gt;&gt; /var/spool/cron/root
<span style="color:#6272a4">#vos硬盘坏掉克隆</span>
dd <span style="color:#ff79c6">if</span><span style="color:#ff79c6">=</span>/dev/sda <span style="color:#8be9fd;font-style:italic">of</span><span style="color:#ff79c6">=</span>/dev/sdb

<span style="color:#6272a4">#判断系统版本</span>
cat /etc/redhat-release|sed -r <span style="color:#f1fa8c">&#39;s/.* ([0-9]+)\..*/\1/&#39;</span>

<span style="color:#6272a4">#重新授权</span>
wget https://1nth.oss-cn-beijing.aliyuncs.com/vos30002140.bin --no-check-certificate
chmod <span style="color:#bd93f9">777</span> vos30002140.bin
./vos30002140.bin

<span style="color:#6272a4">#随机在某区间输入</span>
shuf -i20001-65535 -n1

<span style="color:#6272a4">#检查端口是否开放</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;&#34;</span> &gt; /dev/tcp/192.168.2.250/2777
<span style="color:#6272a4">#递归查询/opt/war下面的文件包含api字符的列表</span>
find /opt/war |xargs grep -ri <span style="color:#f1fa8c">&#34;api&#34;</span> -l
<span style="color:#6272a4">#按照日期列出文件</span>
find . -type f -printf <span style="color:#f1fa8c">&#34;\n%AD %AT %p&#34;</span> |grep <span style="color:#f1fa8c">&#34;09/21/18 04:43:00&#34;</span>
<span style="color:#6272a4">#列出文件</span>
find . -type f
mkdir ~/.ssh
chmod <span style="color:#bd93f9">700</span> ~/.ssh
cat <span style="color:#f1fa8c">&lt;&lt;EOF&gt;&gt; ~/.ssh/authorized_keys
</span><span style="color:#f1fa8c">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAmtqD0IdgMQbd9lBlQsrDyax8q7xPvvS+Cver6lp6cMfhi4vBQX8olf+aE7eUqjQIYE1DXQ4QNjqh42qkdY2AZt3PaTB44CG8BprSsqbcARHlRmIMqx5o8d7I9dqHPb4gPjPScH9PY1kKJ6MQiJnoUawIXIyQD5vRabaJ5Xd9Lky/oTo3pyofLiaaINZpjJWX6LheoxWojziloJ0VGlKFKppS2N8oMnxyxpwE7y1tGW1taBsk2UcPFQ94qpkieiix1XfP6BbJiV/5p60ukIUwKPVpnNxYf97LOhk4W6JmngZLLcI3Ueuvzvxi2JruKplQPUgRcmGLLZQ3JS8qkF/DTQ== root@localhost
</span><span style="color:#f1fa8c">EOF</span>

chmod <span style="color:#bd93f9">644</span> ~/.ssh/authorized_keys
sed -i <span style="color:#f1fa8c">&#39;s/^HISTSIZE=1000/HISTSIZE=65535/&#39;</span> /etc/profile
cat <span style="color:#f1fa8c">&lt;&lt;EOF&gt;&gt; /etc/profile
</span><span style="color:#f1fa8c">export PROMPT_COMMAND=&#39;{ msg=\$(history 1|{ read x y;echo \$y; } );logger &#34;[euid=\$(whoami)]&#34;:\$(who am i):[\`pwd\`]&#34;\$msg&#34;;}&#39;
</span><span style="color:#f1fa8c">EOF</span>
<span style="color:#8be9fd;font-style:italic">source</span> /etc/profile
chattr +a /var/log/messages

<span style="color:#8be9fd;font-style:italic">echo</span> &gt;/var/log/wtmp
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/btmp
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/lastlog
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/secure
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; ~/.bash_history
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; ~/.mysql_history
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/messages
<span style="color:#8be9fd;font-style:italic">history</span> -c 


cat <span style="color:#f1fa8c">&lt;&lt;EOF&gt; /etc/hosts.allow
</span><span style="color:#f1fa8c">#hh
</span><span style="color:#f1fa8c">sshd:59.188.10.*
</span><span style="color:#f1fa8c">#tdxy
</span><span style="color:#f1fa8c">sshd:120.132.80.222
</span><span style="color:#f1fa8c">#cvm
</span><span style="color:#f1fa8c">sshd:140.143.237.96
</span><span style="color:#f1fa8c">sshd:140.143.236.106
</span><span style="color:#f1fa8c">#ECS
</span><span style="color:#f1fa8c">sshd:60.205.57.14
</span><span style="color:#f1fa8c">sshd:60.205.56.244
</span><span style="color:#f1fa8c">sshd:124.205.193.74
</span><span style="color:#f1fa8c">EOF</span>

cat <span style="color:#f1fa8c">&lt;&lt;EOF&gt; /etc/hosts.deny
</span><span style="color:#f1fa8c">sshd:all
</span><span style="color:#f1fa8c">EOF</span>

wget -P /opt/ http://oss.1nth.com/shell/getip.sh
<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;* */1 * * * bash /opt/getip.sh&#34;</span> &gt;&gt; /var/spool/cron/root

linx自定义终端
vim .bashrc
<span style="color:#8be9fd;font-style:italic">PS1</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\[\e[37;40m\][\[\e[32;40m\]\u\[\e[37;40m\]@\h \[\e[35;40m\]\w\[\e[0m\]]\\</span>$<span style="color:#f1fa8c"> </span><span style="color:#f1fa8c">&#34;</span>
<span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">PROMPT_COMMAND</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{ msg=$(history 1 | { read x y; echo $y; });user=$(whoami); echo $(date &#34;+%Y-%m-%d %H:%M:%S&#34;):$user:`pwd`/:$msg ---- $(who am i); } &gt;&gt; /tmp/`hostname`.`whoami`.history-timestamp&#39;</span>

<span style="color:#6272a4">#反复删除文件</span>
shred -zvu -n <span style="color:#bd93f9">5</span> *

<span style="color:#6272a4">#删除xxx以外文件</span>
<span style="color:#8be9fd;font-style:italic">shopt</span> -u extglob <span style="color:#6272a4">#关闭</span>
<span style="color:#8be9fd;font-style:italic">shopt</span> -s extglob <span style="color:#6272a4">#打开</span>

<span style="color:#8be9fd;font-style:italic">shopt</span> -s extglob
rm -rf !<span style="color:#ff79c6">(</span>acl.conf.xml|event_socket.conf.xml|modules.conf.xml<span style="color:#ff79c6">)</span>
ls | grep -v keep | xargs rm
rm <span style="color:#f1fa8c">`</span>ls | grep -v<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">^aa</span>$<span style="color:#f1fa8c">&#34;</span> <span style="color:#f1fa8c">`</span>

/home/kunshiweb/base/apache-tomcat/webapps/chs
<span style="color:#6272a4">#linux记录用户行为</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;/usr/bin/script -qaf /var/log/$USER-$UIDO-`date +%Y%m%d%H%M`.log&#39;</span> &gt;&gt;/root/.bash_profile
<span style="color:#6272a4">#配置环境变量记录用户行为</span>
<span style="color:#8be9fd;font-style:italic">export</span> <span style="color:#8be9fd;font-style:italic">PROMPT_COMMAND</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{ msg=$(history 1|{ read x y;echo $y; } );logger &#34;[euid=$(whoami)]&#34;:$(who am i):[`pwd`]&#34;$msg&#34;;}&#39;</span>

<span style="color:#6272a4">#开机时间</span>
awk <span style="color:#f1fa8c">&#39;{a=$1/86400;b=($1%86400)/3600;c=($1%3600)/60;d=$1%60} {printf(&#34;%ddays, %d:%d:%d\n&#34;,a,b,c,d)}&#39;</span> /proc/uptime
<span style="color:#6272a4">#自动回车功能</span>
<span style="color:#f1fa8c">&#39;cp&#39;</span> -dprf /a/crs.war /b/
<span style="color:#f1fa8c">\c</span>p -dprf /a/crs.war /b/
<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;\n&#34;</span> |rpm -ivh vos3000-2.1.4-0.i586.rpm
<span style="color:#8be9fd;font-style:italic">echo</span> y | rm -i a.txt
vos4.0
<span style="color:#6272a4">#修改web密码</span>
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;密码&#39;</span> &gt; /var/www/html/passwd
<span style="color:#6272a4">#查看系统标识码</span>
cat /home/kunshi/vos3000/server/etc/server.conf
<span style="color:#6272a4">#修改mysql密码</span>
update e_user <span style="color:#8be9fd;font-style:italic">set</span> <span style="color:#8be9fd;font-style:italic">password</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;c0c73baafbde78e1c22f1a44e5da636037cc5fcf65859f432b68e910624358d75f9161c54bc3a13058c13ef7cea17caa2bdac369ba10cb9e8d08849297090905&#39;</span> where <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span>1;
update e_user <span style="color:#8be9fd;font-style:italic">set</span> <span style="color:#8be9fd;font-style:italic">password</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;1e99769964ff33ab9d94dd8530c15be9903211eb7f848899dc6d2d842796ef2768f71148ef297dfcf2c77943a154ad7b7ddb7f4c7d339350ff86e4d918214de3&#39;</span> where <span style="color:#8be9fd;font-style:italic">id</span><span style="color:#ff79c6">=</span>1;
flush privileges;
<span style="color:#6272a4">#修改roos进去mysql的密码</span>
<span style="color:#8be9fd;font-style:italic">set</span> password <span style="color:#ff79c6">for</span> root@localhost <span style="color:#ff79c6">=</span> password<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;xiaofan@1&#39;</span><span style="color:#ff79c6">)</span>;
依赖环境
error <span style="color:#ff79c6">while</span> loading shared libraries: libstdc++.so.6: cannot open shared object file: No such file or directory
错误
yum whatprovides libstdc++.so.6
yum install -y libstdc++-4.1.2-55.el5.i386
yum provides <span style="color:#f1fa8c">&#39;*bin/nslookup&#39;</span>
<span style="color:#6272a4">#防火墙出错#ip_conntrack version 2.4 (8192 buckets, 65536 max) - 304 bytes per conntrack需要重启防火墙</span>
vi /etc/sysctl.conf net.ipv4.ip_conntrack_max <span style="color:#ff79c6">=</span> 1048576
vi /etc/modprobe.conf options ip_conntrack <span style="color:#8be9fd;font-style:italic">hashsize</span><span style="color:#ff79c6">=</span>131072

<span style="color:#6272a4">#替换回车</span>
sed <span style="color:#f1fa8c">&#34;:a;N;s/\n//g;ta&#34;</span>
<span style="color:#6272a4">#yum错误</span>
There are unfinished transactions remaining. You might consider running yum-complete-transaction first to finish them.
The program yum-complete-transaction is found in the yum-utils package.
<span style="color:#6272a4">#解决方法</span>
yum install yum-utils
yum-complete-transaction --cleanup-only
package-cleanup --dupes
package-cleanup --problems
yum安装crontab
yum install -y vixie-cron
yum install -y crontabs
chkconfig --level <span style="color:#bd93f9">345</span> crond on
<span style="color:#6272a4">#为避免这种问题，在64位系统中，要同时安装64位的包和32位的兼容包</span>
yum install glibc.i686 -y
<span style="color:#6272a4">#perl报错</span>
error: unpacking of archive failed on file /usr/bin/dbiprof;599ce193: cpio: open failed - Permission denied
解决方法
lsattr /usr | grep bin ----i-----I-- /usr/bin
chattr -i /usr/bin
<span style="color:#6272a4">#关机</span>
shutdown -h +240  &amp;
shutdown -h 20:00
内核报错
ip_conntrack version 2.4 <span style="color:#ff79c6">(</span><span style="color:#bd93f9">8192</span> buckets, <span style="color:#bd93f9">65536</span> max<span style="color:#ff79c6">)</span> - <span style="color:#bd93f9">228</span> bytes per conntrack
vi /etc/sysctl.conf
net.ipv4.netfilter.ip_conntrack_max <span style="color:#ff79c6">=</span> 655350
net.ipv4.netfilter.ip_conntrack_tcp_timeout_established <span style="color:#ff79c6">=</span> 1200
问题处理
PAM <span style="color:#ff79c6">[</span>error: /lib/security/pam_fprintd.so: cannot open shared object file: No such file or directory<span style="color:#ff79c6">]</span>
yum install fprintd-pam
或者
authconfig --disablefingerprint --update

<span style="color:#6272a4">#yum报错error: db3 error(-30974) from dbenv-&gt;open: DB_RUNRECOVERY: Fatal error, run database recovery</span>
rm -f /var/lib/rpm/__db*
db_verify /var/lib/rpm/Packages
rpm --rebuilddb

<span style="color:#6272a4">#yum源私有仓库</span>
<span style="color:#6272a4">#centos5.x</span>
mkdir -p /etc/yum.repos.d/backup/
mv -f /etc/yum.repos.d/* /etc/yum.repos.d/backup/  &gt;/dev/null 2&gt;&amp;1
curl -L  http://oss.1nth.com/repo/Centos-5/Myki.repo -o  /etc/yum.repos.d/Centos-Base.repo
yum clean all
yum makecache

mv -f /etc/yum.repos.d/* /etc/yum.repos.d/backup/  &gt;/dev/null 2&gt;&amp;1
cat <span style="color:#f1fa8c">&lt;&lt;EOF&gt; /etc/yum.repos.d/CentOS.repo
</span><span style="color:#f1fa8c">[base]
</span><span style="color:#f1fa8c">name=CentOS
</span><span style="color:#f1fa8c">name=CentOS- - Base - Myki
</span><span style="color:#f1fa8c">baseurl=http://yum.1nth.com/base/$basearch/
</span><span style="color:#f1fa8c">gpgcheck=1
</span><span style="color:#f1fa8c">gpgkey=http://yum.1nth.com/base/$basearch/RPM-GPG-KEY-CentOS-5
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">[epel]
</span><span style="color:#f1fa8c">name=epel-Myki
</span><span style="color:#f1fa8c">baseurl=http://epel.1nth.com/epel/$releasever/$basearch/
</span><span style="color:#f1fa8c">failovermethod=priority
</span><span style="color:#f1fa8c">enabled=1
</span><span style="color:#f1fa8c">gpgcheck=1
</span><span style="color:#f1fa8c">gpgkey=http://epel.1nth.com/epel/RPM-GPG-KEY-EPEL-5
</span><span style="color:#f1fa8c">EOF</span>

<span style="color:#6272a4">#centos6.x</span>
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo
curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-6.repo

<span style="color:#6272a4">#centos7.x</span>
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo

<span style="color:#6272a4">#环境配置</span>
yum remove -y perl-DBI  jdk  mysql-libs
yum install -y wget ntpdate glibc.i686 zip unzip crontabs sudo
sed -i <span style="color:#f1fa8c">&#39;/^SELINUX=/cSELINUX=disabled&#39;</span> /etc/selinux/config
<span style="color:#8be9fd;font-style:italic">echo</span>  <span style="color:#f1fa8c">&#34;127.0.0.1 www.linknat.com&#34;</span> &gt;&gt; /etc/hosts
wget -qO /etc/sysctl.conf https://oss.1nth.com/environment/aliyun-sysctl.conf --no-check-certificate
ntpdate time.sicdt.com <span style="color:#ff79c6">&amp;&amp;</span> hwclock -w
<span style="color:#6272a4">#内核确认</span>
wget https://1nth.oss-cn-beijing.aliyuncs.com/kernel-2.6.32-358.el6.x86_64.rpm
rpm -ivh kernel-2.6.32-358.el6.x86_64.rpm --oldpackage


运行setup,打开iptables<span style="color:#ff79c6">(</span>注意：必须将ssh端口加入白名单，否则会导致连不上服务器<span style="color:#ff79c6">)</span> 还有关闭selinux
<span style="color:#6272a4">#阿里云内网</span>
wget http://21k.oss-cn-qingdao-internal.aliyuncs.com/vospag/vos3000-2.1.4.0.tar.gz
<span style="color:#6272a4">#网络下载</span>
wget http://oss.1nth.com/vospag/vos3000-2.1.4.0.tar.gz
tar -zxvf vos3000-2.1.4.0.tar.gz
<span style="color:#8be9fd;font-style:italic">cd</span> vos4.0/
setenforce 0
sh create_user_kunshi.sh
sh create_user_kunshiweb.sh
yum localinstall -y perl-DBI-1.40-5.i386.rpm --nogpgcheck
rpm -qa|grep -i mysql
rpm -ivh MySQL-server-community-5.0.96-1.rhel5.x86_64.rpm
rpm -ivh MySQL-client-community-5.0.96-1.rhel5.x86_64.rpm
tee /etc/my.cnf <span style="color:#f1fa8c">&lt;&lt;-&#39;EOF&#39;
</span><span style="color:#f1fa8c">[client]
</span><span style="color:#f1fa8c">port=3306
</span><span style="color:#f1fa8c">default-character-set=utf8
</span><span style="color:#f1fa8c">[mysqld]
</span><span style="color:#f1fa8c">default-character-set=utf8
</span><span style="color:#f1fa8c">max_connections=160
</span><span style="color:#f1fa8c">interactive_timeout=310000
</span><span style="color:#f1fa8c">wait_timeout=31000
</span><span style="color:#f1fa8c">query_cache_size=48M
</span><span style="color:#f1fa8c">table_cache=320
</span><span style="color:#f1fa8c">tmp_table_size=52M
</span><span style="color:#f1fa8c">thread_cache_size=8
</span><span style="color:#f1fa8c">sort_buffer_size=256K
</span><span style="color:#f1fa8c">innodb_thread_concurrency=8
</span><span style="color:#f1fa8c">myisam-recover=FORCE
</span><span style="color:#f1fa8c">max_allowed_packet=32M
</span><span style="color:#f1fa8c">innodb_file_per_table=1
</span><span style="color:#f1fa8c">EOF</span>

service mysql restart
rpm -ivh jdk-6u45-linux-amd64.rpm
tar zxvf apache-tomcat-7.0.23.tar.gz
mv apache-tomcat-7.0.23 /home/kunshiweb/base/apache-tomcat
chmod <span style="color:#bd93f9">777</span> jrockit-jdk1.6.0_45-R28.2.7-4.1.0-linux-x64.bin
./jrockit-jdk1.6.0_45-R28.2.7-4.1.0-linux-x64.bin

cp -r /root/jrockit-jdk1.6.0_45-R28.2.7-4.1.0 /home/kunshi/base/jdk_default
cp -r /root/jrockit-jdk1.6.0_45-R28.2.7-4.1.0 /home/kunshiweb/base/jdk_default
rpm -ivh vos3000-2.1.4-0.i586.rpm

rpm -ivh emp-2.1.4-0.noarch.rpm
rpm -ivh callservice-2.1.4-0.i586.rpm
rpm -ivh mgc-2.1.4-0.i586.rpm

rpm -ivh vos3000-web*.rpm

rpm -ivh mbx3000-2.1.4-0.i586.rpm
rpm -ivh ivr_dial-2.1.4-0.i586.rpm
rpm -ivh callcenter-2.1.4-0.i586.rpm
<span style="color:#8be9fd;font-style:italic">cd</span> phoneservice/
cp -r phoneservice /home/kunshi/
chmod <span style="color:#bd93f9">777</span> /home/kunshi/phoneservice/bin/phoneservice
cp -r phoneserviced /etc/init.d/
chmod <span style="color:#bd93f9">777</span> /etc/rc.d/init.d/phoneserviced
chkconfig phoneserviced on
service phoneserviced restart
<span style="color:#8be9fd;font-style:italic">cd</span> ..
chmod <span style="color:#bd93f9">777</span> vos30002140.bin
./vos30002140.bin
ifconfig


mkdir /home/kunshi/license
mv -f *_license.dat /home/kunshi/license/license.dat
chmod <span style="color:#bd93f9">777</span> -R /home/kunshi/license/
chown kunshi:kunshi -R /home/kunshi/license/
wget http://oss.1nth.com/vospag/vos2.4pag.tar.gz
tar xzf vos2.4pag.tar.gz
mv -f libcap.so /home/kunshi/vos3000/server/lib/libcap.so &gt;/dev/null
mv -f vos3000d /etc/init.d/vos3000d  &gt;/dev/null
mv -f vos3000webct /etc/init.d/vos3000webct  &gt;/dev/null
chmod <span style="color:#bd93f9">777</span> /home/kunshi/vos3000/server/lib/libcap.so
chown kunshi:kunshi /home/kunshi/vos3000/server/lib/libcap.so
chmod <span style="color:#bd93f9">770</span> /etc/init.d/vos3000webct
chown kunshiweb:kunshiweb /etc/init.d//vos3000webct
chmod <span style="color:#bd93f9">770</span> /etc/init.d/vos3000d
chown kunshi:kunshi /etc/init.d/vos3000d
rm -rf vos3000d vos3000webct libcap.so vos2.4pag.tar.gz

<span style="color:#6272a4">#安全</span>
yum install -y denyhosts httpd php fail2ban
<span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;[DEFAULT]
</span><span style="color:#f1fa8c">ignoreip = 127.0.0.1
</span><span style="color:#f1fa8c">bantime  = 36000
</span><span style="color:#f1fa8c">findtime  = 600
</span><span style="color:#f1fa8c">maxretry = 3
</span><span style="color:#f1fa8c">[ssh-iptables]
</span><span style="color:#f1fa8c">enabled  = true
</span><span style="color:#f1fa8c">filter   = sshd
</span><span style="color:#f1fa8c">action   = iptables[name=SSH, port=10022, protocol=tcp]
</span><span style="color:#f1fa8c">           sendmail-whois[name=SSH, dest=root, sender=fail2ban@example.com]
</span><span style="color:#f1fa8c">logpath  = /var/log/secure
</span><span style="color:#f1fa8c">maxretry = 5&#39;</span> &gt;/etc/fail2ban/jail.local 
service denyhosts restart
chkconfig denyhosts on
wget -P /opt https://oss.1nth.com/MbxWatch.sh --no-check-certificate
chmod <span style="color:#bd93f9">777</span> /opt/MbxWatch.sh
<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;1 */1 * * * /opt/MbxWatch.sh&#34;</span> &gt;&gt; /var/spool/cron/root

chkconfig httpd on
chkconfig fail2ban on
sed -i <span style="color:#f1fa8c">&#39;s/SS_SIP_PORT=&#34;5060,6060&#34;/SS_SIP_PORT=&#34;1980,6060&#34;/g&#39;</span> /home/kunshi/mbx3000/etc/softswitch.conf
sed -i <span style="color:#f1fa8c">&#39;s/port=&#34;8080&#34;/port=&#34;8888&#34;/g&#39;</span> /home/kunshiweb/base/apache-tomcat/conf/server.xml

sed -i <span style="color:#f1fa8c">&#39;/^ACCESS_UUID=/cACCESS_UUID=vos30002140&#39;</span> /home/kunshi/vos3000/server/etc/server.conf


<span style="color:#6272a4">#websecurity</span>
wget http://oss.1nth.com/vospag/vossecurity.bin
sh vossecurity.bin

mysqladmin -u root password <span style="color:#f1fa8c">&#34;xiaofan@1&#34;</span>
sed -i <span style="color:#f1fa8c">&#39;/^Listen/cListen 10000&#39;</span>  /etc/httpd/conf/httpd.conf

sed -i <span style="color:#f1fa8c">&#39;/^#Port/cPort 10022&#39;</span> /etc/ssh/sshd_config
sed -i <span style="color:#f1fa8c">&#34;s/dport 88/dport 10000/g&#34;</span> /etc/sysconfig/iptables
sed -i <span style="color:#f1fa8c">&#34;s/dport 22/dport 10022/g&#34;</span> /etc/sysconfig/iptables
sed -i <span style="color:#f1fa8c">&#34;s/dport 2080/dport 1980/g&#34;</span> /etc/sysconfig/iptables
chattr +i /etc/sysconfig/iptables
<span style="color:#6272a4">#判断ip是否是公网地址</span>
sed -i <span style="color:#f1fa8c">&#39;/^SS_VIRTUAL_IPS=/cSS_VIRTUAL_IPS=172.26.91.204:47.92.234.83&#39;</span> /home/kunshi/mbx3000/etc/params.conf

<span style="color:#6272a4">#数据库迁移位置</span>
rsync -avSH /var/lib/mysql /home/


<span style="color:#6272a4">#如果是centos6.5安装denyhosts需要python安装命令如下</span>
wget http://nchc.dl.sourceforge.net/project/denyhosts/denyhosts/2.6/DenyHosts-2.6.tar.gz
tar xf DenyHosts-2.6.tar.gz
<span style="color:#8be9fd;font-style:italic">cd</span> DenyHosts-2.6
python setup.py install
<span style="color:#8be9fd;font-style:italic">cd</span> /usr/share/denyhosts/
cp daemon-control-dist daemon-control 
cp denyhosts.cfg-dist denyhosts.cfg 
chown root daemon-control
chmod <span style="color:#bd93f9">700</span> daemon-control 
ln -s /usr/share/denyhosts/daemon-control /etc/init.d/denyhosts
chkconfig --add denyhosts
chkconfig denyhosts on
service denyhosts start

<span style="color:#6272a4">#chkconfig * on</span>
<span style="color:#ff79c6">for</span> i in callcenterd callserviced empd ivrdiald mbx3000d mgcserverd phoneserviced vos3000d vos3000webct vos3000websv crond iptables httpd mysql ;<span style="color:#ff79c6">do</span> chkconfig <span style="color:#8be9fd;font-style:italic">$i</span> on ;<span style="color:#ff79c6">done</span>
<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#39;00 10 * * * root /usr/sbin/ntpdate -u cn.pool.ntp.org &gt; /dev/null 2&gt;&amp;1; /sbin/hwclock -w \
</span><span style="color:#f1fa8c">0 0 */3 * * rm -rf /home/kunshi/license/license.dat \
</span><span style="color:#f1fa8c">01 01 * * * /etc/init.d/iptables restart&#39;</span> <span style="color:#f1fa8c">\</span>
&gt;&gt; /var/spool/cron/root
hwclock -s	<span style="color:#6272a4">#硬件时间同步到系统</span>
hwclock -w  <span style="color:#6272a4">#系统时间同步到硬件</span>

tee /etc/sysconfig/iptables <span style="color:#f1fa8c">&lt;&lt;-&#39;EOF&#39;
</span><span style="color:#f1fa8c">#iptables
</span><span style="color:#f1fa8c"># Generated by iptables-save v1.3.5 on Fri Jul 22 20:35:06 2016
</span><span style="color:#f1fa8c">*filter
</span><span style="color:#f1fa8c">:INPUT DROP [5:200]
</span><span style="color:#f1fa8c">:FORWARD ACCEPT [0:0]
</span><span style="color:#f1fa8c">:OUTPUT ACCEPT [4:328]
</span><span style="color:#f1fa8c">-A INPUT -s 43.250.9.14 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.207.92 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.203.25 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.153.99 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.153.108 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.153.104 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.152.9 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.152.2 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 125.65.40.231 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 82.102.16.82 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 27.242.2.121 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 185.107.94.135 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 103.242.3.253 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 118.193.137.76 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 103.228.131.142 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 118.184.31.38 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 118.193.131.237 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 118.193.255.114 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 103.230.123.203 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 103.228.131.229 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 118.193.255.67 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 113.118.186.72 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 218.18.152.69 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 120.25.65.233 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 27.38.250.183 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 113.89.236.100 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 67.229.142.210 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 116.62.194.128 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 47.89.249.205 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 119.137.53.244 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 47.88.78.78 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 120.78.135.255 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 42.51.153.114 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 116.24.154.135 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 115.29.234.201 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 222.95.0.0/255.255.0.0 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 222.45.0.0/255.255.0.0 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -s 58.212.0.0/255.255.0.0 -j DROP
</span><span style="color:#f1fa8c">-A INPUT -i lo -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p tcp -m tcp --dport 88 -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p udp -m udp --dport 2080 -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p tcp -m tcp --dport 10000:49999 -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p udp -m udp --dport 10000:49999 -j ACCEPT
</span><span style="color:#f1fa8c">-A INPUT -p icmp --icmp-type any -j DROP
</span><span style="color:#f1fa8c">-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT
</span><span style="color:#f1fa8c">#-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
</span><span style="color:#f1fa8c">COMMIT
</span><span style="color:#f1fa8c"># Completed on Fri Jul 11 10:18:06 2017
</span><span style="color:#f1fa8c"># 小樊整理防火墙联系21kixc@gmail.com
</span><span style="color:#f1fa8c">EOF</span>

<span style="color:#6272a4">#修改sip端口</span>
sed -i <span style="color:#f1fa8c">&#39;s/SS_SIP_PORT=&#34;5060,6060&#34;/SS_SIP_PORT=&#34;2080,6060&#34;/g&#39;</span> /home/kunshi/mbx3000/etc/softswitch.conf
<span style="color:#6272a4">#修改查费端口</span>
sed -i <span style="color:#f1fa8c">&#39;s/port=&#34;8080&#34;/port=&#34;8888&#34;/g&#39;</span> /home/kunshiweb/base/apache-tomcat/conf/server.xml 

/sbin/iptables  -I INPUT -s 183.15.177.34 -j ACCEPT


<span style="color:#6272a4">#iptables顺序</span>
nat<span style="color:#ff79c6">(</span>prerouting<span style="color:#ff79c6">)</span> -&gt; filter<span style="color:#ff79c6">(</span>input<span style="color:#ff79c6">)</span> -&gt; 本机 -&gt; filter<span style="color:#ff79c6">(</span>output<span style="color:#ff79c6">)</span> -&gt; nat<span style="color:#ff79c6">(</span>postrouting<span style="color:#ff79c6">)</span>
cat /etc/sysconfig/iptables
<span style="color:#6272a4"># Generated by iptables-save v1.3.5 on Mon Jul 16 15:05:10 2018</span>
*filter
:INPUT ACCEPT <span style="color:#ff79c6">[</span>4448:1414784<span style="color:#ff79c6">]</span>
:FORWARD ACCEPT <span style="color:#ff79c6">[</span>0:0<span style="color:#ff79c6">]</span>
:OUTPUT ACCEPT <span style="color:#ff79c6">[</span>4807:1594665<span style="color:#ff79c6">]</span>
:RH-Firewall-1-INPUT - <span style="color:#ff79c6">[</span>0:0<span style="color:#ff79c6">]</span>
-A INPUT -s 58.212.0.0/255.255.0.0 -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j DROP 
-A INPUT -s 222.45.0.0/255.255.0.0 -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j DROP 
-A INPUT -s 222.95.0.0/255.255.0.0 -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j DROP 
-A INPUT -s 172.16.0.0/255.255.0.0 -j DROP 
-A INPUT -s 199.217.0.0/255.255.0.0 -j DROP 
-A INPUT -s 104.193.9.52 -j DROP 
-A INPUT -s 123.65.216.34 -j DROP 
-A INPUT -s 95.211.0.0/255.255.0.0 -j DROP 
-A INPUT -s 207.236.0.0/255.255.0.0 -j DROP 
-A INPUT -p tcp -m tcp --dport <span style="color:#bd93f9">1207</span> -j DROP 
-A INPUT -s 37.8.0.0/255.255.0.0 -j DROP 
-A INPUT -s 82.205.0.0/255.255.0.0 -j DROP 
-A INPUT -s 104.148.64.0/255.255.255.0 -j DROP 
-A INPUT -s 192.99.126.0/255.255.255.0 -j DROP 
-A OUTPUT -d 117.88.0.0/255.255.0.0 -j DROP 
-A OUTPUT -d 123.65.0.0/255.255.0.0 -j DROP 
-A OUTPUT -d 207.236.0.0/255.255.0.0 -j REJECT --reject-with icmp-port-unreachable 
-A OUTPUT -p tcp -m tcp --dport <span style="color:#bd93f9">1207</span> -j DROP 
-A RH-Firewall-1-INPUT -i lo -j ACCEPT 
-A RH-Firewall-1-INPUT -i eth1 -j ACCEPT 
-A RH-Firewall-1-INPUT -i eth0 -j ACCEPT 
-A RH-Firewall-1-INPUT -p icmp -m icmp --icmp-type any -j ACCEPT 
-A RH-Firewall-1-INPUT -d 224.0.0.251 -p udp -m udp --dport <span style="color:#bd93f9">5353</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p udp -m udp --dport <span style="color:#bd93f9">631</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">22</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">2022</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">2233</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">3389</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport 50:50000 -j ACCEPT 
-A RH-Firewall-1-INPUT -p udp -m state --state NEW -m udp --dport 50:50000 -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">51</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">52</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">53</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">54</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">55</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">56</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">57</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">58</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">59</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">80</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">81</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">82</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">83</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">84</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">85</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">86</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">87</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">88</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">89</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1720</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1719</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">2720</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">2719</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">3720</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">3719</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">5060</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">5061</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">6060</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">6061</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">5070</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">5071</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">8080</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">8088</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1701</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1702</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1723</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">47</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1200</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1300</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">1800</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m state --state NEW -m tcp --dport <span style="color:#bd93f9">3600</span> -j ACCEPT 
-A RH-Firewall-1-INPUT -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j LOG --log-level <span style="color:#bd93f9">7</span> 
-A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited 
COMMIT
<span style="color:#6272a4"># Completed on Mon Jul 16 15:05:10 2018</span>
<span style="color:#6272a4"># Generated by iptables-save v1.3.5 on Mon Jul 16 15:05:10 2018</span>
*nat
:PREROUTING ACCEPT <span style="color:#ff79c6">[</span>3:1582<span style="color:#ff79c6">]</span>
:POSTROUTING ACCEPT <span style="color:#ff79c6">[</span>28:8429<span style="color:#ff79c6">]</span>
:OUTPUT ACCEPT <span style="color:#ff79c6">[</span>28:8429<span style="color:#ff79c6">]</span>
-A PREROUTING -s 182.50.122.155 -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j ACCEPT 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">3306</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">2501</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">1202</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">1203</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">1204</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">1205</span> -j DROP 
-A PREROUTING -p tcp -m tcp --dport <span style="color:#bd93f9">143</span> -j DROP 
COMMIT
<span style="color:#6272a4"># Completed on Mon Jul 16 15:05:10 2018</span>


chown mysql:mysql 
apache        <span style="color:#8be9fd;font-style:italic">ALL</span><span style="color:#ff79c6">=</span><span style="color:#ff79c6">(</span>ALL<span style="color:#ff79c6">)</span>       NOPASSWD: ALL
chmod <span style="color:#bd93f9">440</span> /etc/sudoers

/home/kunshiweb/base/apache-tomcat/webapps/chs
<span style="color:#6272a4">#修改4.0web端口号路径</span>
vi /home/kunshiweb/base/apache-tomcat/conf/server.xml
crontab -e
vi /var/spool/cron/root
<span style="color:#bd93f9">1</span> */6 * * * /opt/MbxWatch.sh
<span style="color:#bd93f9">1</span> */1 * * * /opt/freemem.sh
<span style="color:#bd93f9">01</span> <span style="color:#bd93f9">01</span> * * * /etc/init.d/iptables restart




<span style="color:#6272a4">#!/bin/bash</span>
wget http://21k.oss-cn-qingdao.aliyuncs.com/vospag/vossafe.tar.gz
tar -zxvf vossafe.tar.gz

yum clean all
yum makecache
yum install -y httpd php
mv html/ /opt/
<span style="color:#8be9fd;font-style:italic">cd</span> vossafe/
yes|mv httpd.conf /etc/httpd/conf/httpd.conf
yes|mv sudoers /etc/sudoers
yes|mv iptables /etc/sysconfig/iptables
service httpd restart
service iptables restart
chkconfig iptables on
chkconfig httpd on
chkconfig mysql on


<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;1 */6 * * * /opt/MbxWatch.sh\n1 */1 * * * /opt/freemem.sh\n01 01 * * * /etc/init.d/iptables restart&#34;</span> &gt;&gt; /var/spool/cron/root



<span style="color:#8be9fd;font-style:italic">echo</span> -e <span style="color:#f1fa8c">&#34;cheche  ALL=(ALL)       NOPASSWD:ALL&#34;</span> &gt;&gt; /etc/sudoers
<span style="color:#8be9fd;font-style:italic">echo</span> &gt;/var/log/wtmp
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/btmp
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/lastlog
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/secure
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; ~/.bash_history
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; ~/.mysql_history
<span style="color:#8be9fd;font-style:italic">echo</span> &gt; /var/log/messages
<span style="color:#8be9fd;font-style:italic">history</span> -c 
<span style="color:#6272a4">#vos 2009 4.0安装</span>
setenforce 0
sh create_user_kunshi.sh
sh create_user_kunshiweb.sh
rpm -ivh perl-DBI-1.40-5.i386.rpm 
rpm -ivh MySQL-server-community-5.0.96-1.rhel5.x86_64.rpm 
rpm -ivh MySQL-client-community-5.0.96-1.rhel5.x86_64.rpm 
tee /etc/my.cnf <span style="color:#f1fa8c">&lt;&lt;-&#39;EOF&#39;
</span><span style="color:#f1fa8c">service mysql restart
</span><span style="color:#f1fa8c">rpm -ivh jdk-6u45-linux-amd64.rpm
</span><span style="color:#f1fa8c">tar zxvf apache-tomcat-7.0.23.tar.gz
</span><span style="color:#f1fa8c">mv apache-tomcat-7.0.23 /home/kunshiweb/base/apache-tomcat
</span><span style="color:#f1fa8c">chmod 777 jrockit-jdk1.6.0_45-R28.2.7-4.1.0-linux-x64.bin
</span><span style="color:#f1fa8c">./jrockit-jdk1.6.0_45-R28.2.7-4.1.0-linux-x64.bin
</span><span style="color:#f1fa8c">cp -r /root/jrockit-jdk1.6.0_45-R28.2.7-4.1.0 /home/kunshi/base/jdk_default
</span><span style="color:#f1fa8c">cp -r /root/jrockit-jdk1.6.0_45-R28.2.7-4.1.0 /home/kunshiweb/base/jdk_default
</span><span style="color:#f1fa8c">rpm -ivh vos3000-2.1.4-0.i586.rpm
</span><span style="color:#f1fa8c">rpm -ivh vos2009-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">rpm -ivh emp-2.1.4-0.noarch.rpm 
</span><span style="color:#f1fa8c">rpm -ivh callservice-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">rpm -ivh mgc-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">rpm -ivh vos2009-web*.rpm
</span><span style="color:#f1fa8c">rpm -ivh mbx2009-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">rpm -ivh ivr_dial-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">rpm -ivh callservice-2.1.4-0.i586.rpm 
</span><span style="color:#f1fa8c">cd phoneservice/
</span><span style="color:#f1fa8c">cp -r phoneservice /home/kunshi/
</span><span style="color:#f1fa8c">chmod 777 /home/kunshi/phoneservice/bin/phoneservice
</span><span style="color:#f1fa8c">cp -r phoneserviced /etc/init.d/
</span><span style="color:#f1fa8c">chmod 777 /etc/rc.d/init.d/phoneserviced
</span><span style="color:#f1fa8c">chkconfig phoneserviced on
</span><span style="color:#f1fa8c">service phoneserviced restart
</span><span style="color:#f1fa8c">sh vos20092140.bin 
</span><span style="color:#f1fa8c">ifconfig 
</span><span style="color:#f1fa8c">mkdir /home/kunshi/license
</span><span style="color:#f1fa8c">chmod 777 -R /home/kunshi/license/
</span><span style="color:#f1fa8c">mv *license.dat /home/kunshi/license/license.dat
</span><span style="color:#f1fa8c">chown kunshi:kunshi -R /home/kunshi/license/
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">vos4.0卸载命令
</span><span style="color:#f1fa8c">rm -rf /etc/init.d/phoneserviced
</span><span style="color:#f1fa8c">rpm -e callcenter
</span><span style="color:#f1fa8c">rpm -e ivr_dial
</span><span style="color:#f1fa8c">rpm -e mbx3000
</span><span style="color:#f1fa8c">rpm -e $(rpm -qa|grep vos3000-web)
</span><span style="color:#f1fa8c">rpm -e mgc
</span><span style="color:#f1fa8c">rpm -e callservice
</span><span style="color:#f1fa8c">rpm -e emp
</span><span style="color:#f1fa8c">rpm -e vos3000
</span><span style="color:#f1fa8c">rpm -e jdk
</span><span style="color:#f1fa8c">rpm -e $(rpm -qa|grep -i mysql)
</span><span style="color:#f1fa8c">rpm -e perl-DBI
</span><span style="color:#f1fa8c">rm -rf /etc/my.cnf
</span><span style="color:#f1fa8c">rm -rf /var/lib/mysql/
</span><span style="color:#f1fa8c">rm -rf /home/kunshi/
</span><span style="color:#f1fa8c">rm -rf /home/kunshiweb/
</span><span style="color:#f1fa8c">userdel -f kunshi
</span><span style="color:#f1fa8c">userdel -f kunshiweb
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">#mysql迁移位置
</span><span style="color:#f1fa8c">echo &#39;[client]
</span><span style="color:#f1fa8c">port=3306
</span><span style="color:#f1fa8c">default-character-set=utf8
</span><span style="color:#f1fa8c">socket=/data/mysql/mysql.sock
</span><span style="color:#f1fa8c">[mysqld]
</span><span style="color:#f1fa8c">datadir=/data/mysql
</span><span style="color:#f1fa8c">socket=/data/mysql/mysql.sock
</span><span style="color:#f1fa8c">user=mysql
</span><span style="color:#f1fa8c">symbolic-links=0
</span><span style="color:#f1fa8c">default-character-set=utf8
</span><span style="color:#f1fa8c">max_connections=160
</span><span style="color:#f1fa8c">interactive_timeout=310000
</span><span style="color:#f1fa8c">wait_timeout=31000
</span><span style="color:#f1fa8c">query_cache_size=48M
</span><span style="color:#f1fa8c">table_cache=320
</span><span style="color:#f1fa8c">tmp_table_size=52M
</span><span style="color:#f1fa8c">thread_cache_size=8
</span><span style="color:#f1fa8c">sort_buffer_size=256K
</span><span style="color:#f1fa8c">innodb_thread_concurrency=8
</span><span style="color:#f1fa8c">myisam-recover=FORCE</span>
<span style="color:#8be9fd;font-style:italic">max_allowed_packet</span><span style="color:#ff79c6">=</span>32M
<span style="color:#8be9fd;font-style:italic">innodb_file_per_table</span><span style="color:#ff79c6">=</span>1
<span style="color:#ff79c6">[</span>mysqld_safe<span style="color:#ff79c6">]</span>
log-error<span style="color:#ff79c6">=</span>/var/log/mysqld.log
pid-file<span style="color:#ff79c6">=</span>/var/run/mysqld/mysqld.pid<span style="color:#f1fa8c">&#39; &gt; /etc/my.cnf
</span><span style="color:#f1fa8c">sed -i &#39;</span>s#data<span style="color:#f1fa8c">\/</span>mysql#home<span style="color:#f1fa8c">\/</span>mysql#g<span style="color:#f1fa8c">&#39; /etc/my.cnf
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">drwx------ 2 mysql mysql    16384 10月 30 10:47 vos3000
</span><span style="color:#f1fa8c">chown mysql:mysql -R vos3000/
</span><span style="color:#f1fa8c">chmod 700 -R vos3000/
</span><span style="color:#f1fa8c">mount -t ntfs-3g /dev/sdb1 /vosroot
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">mysql_install_db
</span><span style="color:#f1fa8c">#昆石官方升级命令
</span><span style="color:#f1fa8c">ntpdate 172.100.100.1
</span><span style="color:#f1fa8c">netstat -na -t
</span><span style="color:#f1fa8c">netstat -na -u
</span><span style="color:#f1fa8c">mkdir cdr
</span><span style="color:#f1fa8c">cp -dprf vos2009  vos2009backup
</span><span style="color:#f1fa8c">mv  vos2009/e_cdr_2014*  cdr/
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">-java -jar vos30002124reg.jar ip mac rpmtime vostime jdktime ivr line language userinfo timestamp
</span><span style="color:#f1fa8c">java -jar vos30002140.jar 101.37.12.30,10.241.104.203 00-16-3E-12-EA-30 1408326133 1499654430 1499654373 10000 20000 en_us 766F733230303932313430 1600000000
</span><span style="color:#f1fa8c">pause
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">防止vos超频功能
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">#备份mysql
</span><span style="color:#f1fa8c">mysqladmin -uroot -p password xiaofan@1
</span><span style="color:#f1fa8c">set password for root@localhost = password(&#39;</span><span style="color:#f1fa8c">&#39;);
</span><span style="color:#f1fa8c">flush privileges;
</span><span style="color:#f1fa8c">/usr/bin/mysqldump -uroot -pxiaofan@1 vos3000  --skip-lock-tables &gt; /backup/db/&#34;date +&#34;%y-%m-%d&#34;/&#34;vos3000&#34;_&#34;date +&#34;%y-%m-%d&#34;.sql
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">#centos6.4内核
</span><span style="color:#f1fa8c">#修改内核
</span><span style="color:#f1fa8c">rpm -ivh kernel-2.6.32-358.el6.x86_64.rpm --nodeps --force
</span><span style="color:#f1fa8c">rpm -ivh kernel-devel-2.6.32-358.el6.x86_64.rpm
</span><span style="color:#f1fa8c">rpm -ivh kernel-headers-2.6.32-358.el6.x86_64.rpm --nodeps --force
</span><span style="color:#f1fa8c">rpm -ivh kernel-firmware-2.6.32-358.el6.noarch.rpm
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">rpm -e kernel-headers-2.6.32-696.10.1.el6.x86_64
</span><span style="color:#f1fa8c">rpm -e kernel-firmware-2.6.32-696.10.1.el6.noarch
</span><span style="color:#f1fa8c">rpm -e irqbalance-1.0.7-8.el6.x86_64
</span><span style="color:#f1fa8c">rpm -e kernel-2.6.32-696.10.1.el6.x86_64
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">rpm -vih irqbalance-1.0.4-3.el6.x86_64.rpm
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">不记录无效话单
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">负载均衡
</span><span style="color:#f1fa8c">grant all privileges on *.* to cheche@&#34;%&#34; identified by &#34;xiaofan@1&#34; with grant option;
</span><span style="color:#f1fa8c">flush privileges;
</span><span style="color:#f1fa8c">添加访问权限
</span><span style="color:#f1fa8c">show grants;
</span><span style="color:#f1fa8c">create user &#39;</span>root<span style="color:#f1fa8c">&#39;@&#39;</span>10.80.184.48<span style="color:#f1fa8c">&#39; identified by &#34;&#34;;
</span><span style="color:#f1fa8c">grant all on *.* to &#39;</span>root<span style="color:#f1fa8c">&#39;@&#39;</span>10.80.184.48<span style="color:#f1fa8c">&#39;;
</span><span style="color:#f1fa8c">flush privileges;
</span><span style="color:#f1fa8c">select user,host,password from user;
</span><span style="color:#f1fa8c">drop user &#39;</span>root<span style="color:#f1fa8c">&#39;@&#39;</span>10.80.184.48&#39;;
<span style="color:#ff79c6">select</span> user,host,password from mysql.user;

<span style="color:#6272a4">#centos6.11 HTTP报错</span>
<span style="color:#6272a4">#apr_sockaddr_info_get() failed for hostname</span>
vi /etc/httpd/conf/httpd.conf
<span style="color:#6272a4">#ServerName www.example.com:80  ServerName 127.0.0.1</span>


<span style="color:#6272a4">#校验版本失败</span>
bin文件调用zip和unzip
yum install -y zip unzip

public的key导入到rt.jar

zip -r /usr/java/jdk1.6.0_45/jre/lib/rt.jar java &gt;/dev/null 2&gt;/dev/null
zip -r /home/kunshi/base/jdk_default/jre/lib/rt.jar java &gt;/dev/null 2&gt;/dev/null
zip -r /home/kunshiweb/base/jdk_default/jre/lib/rt.jar java &gt;/dev/null 2&gt;/dev/null

2.0web后门
 /usr/kunshi/vos2009/webclient/jsp/query-terminal.jsp
此文件安装之后一定要删除

</code></pre></div>

        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f&amp;text=vos%203000%202.1.4.0%20%e5%ae%89%e8%a3%85&amp;via=MykiFan" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f&amp;title=vos%203000%202.1.4.0%20%e5%ae%89%e8%a3%85" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f&amp;title=vos%203000%202.1.4.0%20%e5%ae%89%e8%a3%85" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f&amp;title=vos%203000%202.1.4.0%20%e5%ae%89%e8%a3%85" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.1nth.com%2fpost%2fvos4.0_insall%2f&amp;description=vos%203000%202.1.4.0%20%e5%ae%89%e8%a3%85" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
          
            <li class="next">
              <a href="https://www.1nth.com/post/esxi_install/" data-toggle="tooltip" data-placement="top" title="ESXI安装"> &rarr;</a>
            </li>
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:21kixc@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/21ki" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/MykiFan" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/12089012/myki" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/myki" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/user/Myki" title="Youtube">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://paypal.me/username" title="PayPal">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-paypal fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://telegram.me/username" title="Telegram">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-telegram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://weibo.com/%e7%a6%bb%e5%b2%9b%e4%b9%8b%e5%90%8e" title="Weibo">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-weibo fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="1nth.com">Myki</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2019
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://www.1nth.com/">Myki的博客</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://www.1nth.com/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://www.1nth.com/js/load-photoswipe.js"></script>









    
  </body>
</html>

